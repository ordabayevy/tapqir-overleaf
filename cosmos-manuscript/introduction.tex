\section{Introduction}

A central concern of modern biology is understanding at the molecular level the chemical and physical mechanisms by which protein and nucleic acid macromolecules  perform essential cellular functions.  The operation of many such macromolecules requires that they work not as isolated molecules in solution but as components of dynamic molecular complexes that self-assemble and change structure and composition as they function.  For more than  two decades, scientists have successfully explored the molecular mechanisms of many such complex and dynamic systems using multi-wavelength single molecule fluorescence methods such as smFRET (single-molecule fluorescence resonance energy transfer) \citep{Roy2008-fo} and single-molecule co-localization methods like CoSMoS (co-localization single molecule spectroscopy) \citep{Larson2014-os, Van_Oijen2011-ig}.

In its simplest implementation, CoSMoS is a technique to visualize transient interactions between individual molecules.  Dye-labeled protein or nucleic acid target molecules are immobilized on a slide surface and TIRF (total internal reflection fluorescence) microscopy is employed to detect co-localizations between those targets and other dye-labeled molecules that might bind those targets during a biochemical reaction.  The CoSMoS method has been used for elucidating the mechanisms of complex biochemical processes \textit{in vitro}. Examples include cell cycle regulation \citep{Lu2015-eu}, ubiquitination and proteasome-mediated protein degradation \citep{Lu2015-jq}, DNA replication \citep{Geertsema2014-bt,Ticau2015-ib}, transcription \citep{Zhang2012-no,Friedman2012-if,Friedman2013-sf}, micro-RNA regulation \citep{Salomon2015-kq}, pre-mRNA splicing \citep{Shcherbakova2013-bi, Krishnan2013-fy, Warnasooriya2014-ls}, ribosome assembly \citep{Kim2014-zc}, translation \citep{Wang2015-tt,Tsai2014-mi,OLeary2013-wo}, signal recognition particle-nascent protein interaction \citep{Noriega2014-vj}, and cytoskeletal regulation \citep{Smith2013-qj,Breitsprecher2012-mj}. CoSMoS is extensively used by labs that specialize in the technique and is increasingly being adopted by non-specialist labs as well. With the availability of good commercial TIRF microscopes, data analysis methodology is a major challenge in adoption and use of the CoSMoS technique.

Analysis of CoSMoS data is an intrinsically challenging and time-consuming problem. Although CoSMoS images are conceptually simple -- they consist only of diffraction-limited fluorescent spots collected in several wavelength channels -- efficient analysis of the images, reliable extraction of kinetic data, and fitting to model biochemical mechanisms are inherently challenging for several reasons. First, the number of photons emitted by a single fluorophore is limited by fluorophore photobleaching. Consequently, in many CoSMoS experiments one must work at the lowest feasible excitation power in order to maximize the duration of experimental recordings and to capture relevant kinetics. Achieving higher time resolution divides the number of emitted photons between a larger number of images. The required concentrations of fluorescently tagged molecules can sometimes create significant background noise \citep{Peng2018-ge, Van_Oijen2011-ig}, even with zero-mode waveguide instruments \citep{Chen2014-jd}. These technical difficulties result in CoSMoS images that frequently have low signal-to-noise (S/N) ratios, making discrimination of real fluorescent spots from noise a major challenge. Second, there are transient non-specific interactions of the binder molecule with the surface of the microscope slide, and these non-specific interactions can give rise to both false positive and false negative detections. Additional measurements and modeling of these non-specific surface interactions must be employed to avoid errors in derived kinetic parameters or inferred mechanisms.

All of the current CoSMoS analysis methods involve a two-step process. In the first co-localized spot detection step, binary information at each time point about whether a binder molecule fluorescence spot is observed at the image position of a target molecule is obtained. In the second step, kinetic parameters are extracted from the on- and off- dwell time distributions. Some spot detection methods are based on integrating the binder fluorescence intensity over small regions of the image (typically squares $\sim$0.4 $\mu$m on a side) centered on the location of the target molecule, and then using crossings of set intensity threshold(s) to score binder molecule arrival and departure. For reasons described in detail elsewhere \citep{Friedman2015-nx}, these approaches are both imprecise and inaccurate, particularly when applied to the low S/N images often used. A fundamental problem with these methods is that they rely on the integrated intensity and thus discard spatial information contained in the images that can and should be used to objectively inform decisions about spot presence.

More recent spot detection methods are based on extracting quantitative features of the spot (e.g., intensity profile, size, shape, and distance to target) from the 2-D image and then identifying spots using manually chosen thresholds for these parameters \citep{Friedman2015-nx, Smith2019-yb}. These image analysis based methods are more accurate than previous approaches in part because they make use of information contained in the 2-D images that are disregarded when only the integrated intensity is used \citep{Friedman2015-nx}. While these methods greatly improve CoSMoS data analysis, they nevertheless suffer from significant deficiencies. First, current methods require subjective choice of user-set thresholds for spot amplitude, diameter and proximity. These settings significantly affect error rates and no objective method to select them currently exists, making the approach non-robust and overly complicated. Second, it is unsatisfying from a theoretical perspective that existing analysis methods are performed in multiple step with a loss of information about the uncertainties at each step of the analysis. Spot detection is performed on the extracted features of the spot and not the raw 2-D images themselves. Furthermore, spot detection step produces only a binary output (spot present or absent); they do not output the probability of spot presence in marginal images, a critical feature in the analysis of low S/N data. Kinetic analysis, in turn, is based on the binary output of the spot detection step, further reducing the amount of information transmitted from the raw images. Third, it is nontrivial to incorporate prior knowledge (e.g., co-localization accuracy, size of the spot, frequency of non-specific binding) into these analysis methods.

To solve these problems we adopt a Bayesian inference approach which provides a natural means to combine prior information with data in a rigorous statistical framework. Bayesian inference uses Bayes' theorem to provide a probability distribution for unobserved model parameters conditional on observed data. We define a probabilistic generative model which can be interpreted as a causal process that produces the observed data. In our case observed data corresponds to an image at a target site (matrix of pixel intensities). The observed images are generated according to the likelihood function (noise model) for different settings of latent variables such as background intensity, number of spots in the image, position, shape, and intensity of each individual spot. The latent variables, in turn, are sampled from prior distributions. Prior distributions can be used to embed our knowledge into the model such as the distribution of the position of the spot depending whether it is on-target of off-target spot. Prior distributions can also represent global parameters of the model as in the case with the average probability of observing a spot in the image.

In this article, we present Bayesian approach for analysis and interpretation of CoSMoS data. Our new method: 1) provides uncertainties for all of the model parameters including a spot probability estimate for each image (not merely a Boolean spot/no spot classification) 2) maximizes extraction of useful information from data (particularly at the low S/N inherent to many CoSMoS experiments) by analyzing raw images, not just fluorescence intensities; 2) defines a unified probabilistic model which allows one to directly infer model parameters from CoSMoS image data; 3) explicitly models non-specific interactions of the binder molecule with the surface which allows to jointly analyze negative control dataset; 4) uses Gamma distribution as a more realistic intensity noise model rather than Gaussian distribution; 5) has a flexible framework that can naturally be extended to kinetic models and multi-wavelength analysis. Our new analysis method will increase the accessibility of the CoSMoS method to investigators that have important biological problems to solve but are not able to develop their own data analysis methods or to reliably use the current data analysis approaches which require parameter tweaking. The method developed here eliminates this dependence on subjective parameter adjustments and includes built-in tools for statistical assessment of the validity of the results as essential steps in the analysis process.