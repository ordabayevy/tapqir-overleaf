\section{Supplementary Material}

\input{cosmos-manuscript/algorithm}

\begin{table}
\caption{\label{tab:example}Probability distributions used in the model.}
% Use "S" column identifier to align on decimal point 
\begin{tabular}{l l}
\toprule
Distribution & PDF \\
\midrule
$x \sim \textbf{AffineBeta}(\mu, \nu, a, b)$ &
    $\dfrac{y^{\alpha-1}(1-y)^{\beta-1}}{\text{B}(\alpha, \beta)}$
    where $\alpha=\dfrac{\nu (\mu-a)}{b-a}$, $\beta=\dfrac{\nu (b-\mu)}{b-a}$, and $y = \dfrac{x-a}{b-a}$ \\
$x \sim \textbf{Bernoulli}(\pi)$ &
    $\pi^x (1-\pi)^{1-x}$ \\
$x \sim \textbf{Beta}(\alpha, \beta)$ &
    $\dfrac{x^{\alpha-1}(1-x)^{\beta-1}}{\text{B}(\alpha, \beta)}$ \\
$x \sim \textbf{Categorical}_{\{z_i\}^k_{i=1}}(\bm{p})$ &
    $\prod_{i=1}^k p_i^{[x=z_i]}$ \\
$x \sim \textbf{Gamma}(\mu, \sigma)$ &
    $\dfrac{\beta^\alpha}{\Gamma(\alpha)}x^{\alpha-1} e^{-\beta x}$
    where $\alpha = \dfrac{\mu^2}{\sigma^2}$ and $\beta = \dfrac{\mu}{\sigma^2}$ \\
$x \sim \textbf{HalfNormal}(\sigma)$ &
    $\dfrac{\sqrt{2}}{\sigma \sqrt{\pi}} \exp \left( -\dfrac{x^2}{2\sigma^2} \right)$
    for  $x > 0$ \\
$x \sim \textbf{Uniform}(a, b)$ &
    $\dfrac{1}{b-a}$ for $x \in [a, b]$ \\
\bottomrule
\end{tabular}
\end{table}


\begin{equation}
\begin{aligned}
    & p(b, \theta, m, h, w, x, y, I, D) = \\
    & \prod^N_{n=1} \prod^F_{f=1} p(b_{nf} | \mu^b_n, \sigma^b_n) p(\theta_{nf} | \pi^z) \\
    & \prod^K_{k=1} p(m_{knf} | \pi^z, \pi^j, \theta_{nf}) p(h_{knf} | m_{knf})
    p(w_{knf} | m_{knf})
    p(x_{knf} | m_{knf}, \theta_{nf}) p(y_{knf} | m_{knf}, \theta_{nf}) \\
    & \prod^P_{i=1} \prod^P_{j=1} p(I_{nfij} | \mu^I_{nfij}, \gamma)
    p(\delta_{nfij} | \bm{\pi}^\delta)
    p(D_{nfij} | I_{nfij}, \delta_{nfij})
\end{aligned}
\end{equation}